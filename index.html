<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>AR Bot Fast</title>
    
    <!-- –°—Ç–∏–ª–∏ -->
    <style>
        body { margin: 0; overflow: hidden; background-color: #000; font-family: sans-serif; }
        
        /* –≠–∫—Ä–∞–Ω –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏—è (—á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–æ –Ω–∞ iPhone) */
        #start-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            z-index: 9999;
            display: flex; flex-direction: column; align-items: center; justify-content: center;
        }
        
        button {
            padding: 15px 30px; font-size: 18px; font-weight: bold;
            color: white; background: #ff0055; border: none; border-radius: 50px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.3); cursor: pointer;
        }

        /* –ö–æ–Ω—Å–æ–ª—å –æ—à–∏–±–æ–∫ –Ω–∞ —ç–∫—Ä–∞–Ω–µ (–¥–ª—è –æ—Ç–ª–∞–¥–∫–∏) */
        #debug {
            position: fixed; top: 10px; left: 10px; z-index: 10000;
            color: #00ff00; background: rgba(0,0,0,0.5); padding: 5px;
            font-size: 10px; max-width: 80%; pointer-events: none;
        }

        /* UI –≤–Ω—É—Ç—Ä–∏ AR */
        #ar-ui {
            display: none; position: fixed; bottom: 20px; width: 100%; text-align: center; z-index: 100;
        }
    </style>

    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –ª–µ–≥–∫–∏–µ –≤–µ—Ä—Å–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ -->
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
    <!-- –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ—Å—Ç—É—é –≤–µ—Ä—Å–∏—é AR.js -->
    <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>

<body>

    <!-- 1. –≠–∫—Ä–∞–Ω —Å—Ç–∞—Ä—Ç–∞ -->
    <div id="start-screen">
        <h1 style="color:white; margin-bottom: 20px;">AR TELEGRAM</h1>
        <button onclick="startCamera()">üì∏ –ó–ê–ü–£–°–¢–ò–¢–¨ –ö–ê–ú–ï–†–£</button>
        <p style="color: #ccc; margin-top: 20px; font-size: 12px;">–†–∞–∑—Ä–µ—à–∏—Ç–µ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è</p>
    </div>

    <!-- 2. –õ–æ–≥ –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ -->
    <div id="debug">System ready...</div>

    <!-- 3. –ö–Ω–æ–ø–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è (—Å–∫—Ä—ã—Ç–∞ –ø–æ–∫–∞ –Ω–µ—Ç AR) -->
    <div id="ar-ui">
        <button onclick="finishTask()" style="background: #00cc66;">‚úÖ –Ø –ù–ê–®–ï–õ –ö–£–ë</button>
    </div>

    <!-- 4. AR –°—Ü–µ–Ω–∞ -->
    <!-- embedded –∏ vr-mode-ui="enabled: false" –≤–∞–∂–Ω—ã –¥–ª—è —Å–∫–æ—Ä–æ—Å—Ç–∏ -->
    <a-scene 
        embedded 
        vr-mode-ui="enabled: false"
        arjs="sourceType: webcam; debugUIEnabled: false; detectionMode: mono_and_matrix; matrixCodeType: 3x3;"
        renderer="logarithmicDepthBuffer: true; antialias: true; alpha: true;"
        id="scene"
        style="display: none;"> <!-- –°–∫—Ä—ã—Ç–∞ –¥–æ —Å—Ç–∞—Ä—Ç–∞ -->

        <!-- –ö–£–ë. position="0 0 -3" –∑–Ω–∞—á–∏—Ç 3 –º–µ—Ç—Ä–∞ –ü–ï–†–ï–î —Ç–µ–ª–µ—Ñ–æ–Ω–æ–º -->
        <a-box 
            position="0 0.5 -3" 
            rotation="0 45 0" 
            color="#4CC3D9" 
            scale="1 1 1"
            animation="property: rotation; to: 0 405 0; loop: true; dur: 4000">
        </a-box>

        <!-- –ö–∞–º–µ—Ä–∞ –±–µ–∑ GPS (–ª–µ–≥–∫–∞—è) -->
        <a-entity camera></a-entity>
    </a-scene>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();
        
        const debugEl = document.getElementById('debug');
        
        function log(msg) {
            debugEl.innerHTML += '<br>' + msg;
            console.log(msg);
        }

        function startCamera() {
            log("–ó–∞–ø—É—Å–∫...");
            
            // 1. –°–∫—Ä—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É —Å—Ç–∞—Ä—Ç–∞
            document.getElementById('start-screen').style.display = 'none';
            
            // 2. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ü–µ–Ω—É
            const scene = document.querySelector('a-scene');
            scene.style.display = 'block';
            
            // 3. –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∫–Ω–æ–ø–∫—É "–ù–∞—à–µ–ª"
            document.getElementById('ar-ui').style.display = 'block';

            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Ç—Ä–∏–≥–≥–µ—Ä–∏–º —Ä–µ—Å–∞–π–∑, —á—Ç–æ–±—ã AR.js –ø–æ–¥—Ö–≤–∞—Ç–∏–ª —Ä–∞–∑–º–µ—Ä—ã —ç–∫—Ä–∞–Ω–∞
            setTimeout(() => {
                window.dispatchEvent(new Event('resize'));
                log("–ö–∞–º–µ—Ä–∞ –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω–∞ (–Ω–∞–¥–µ—é—Å—å)");
            }, 1000);
        }

        function finishTask() {
            tg.HapticFeedback.notificationOccurred('success');
            tg.sendData("–ö—É–± –Ω–∞–π–¥–µ–Ω!");
        }

        // –õ–æ–≤–∏–º –æ—à–∏–±–∫–∏ A-Frame
        document.querySelector('a-scene').addEventListener('loaded', function () {
            log("–°—Ü–µ–Ω–∞ –∑–∞–≥—Ä—É–∂–µ–Ω–∞");
        });
        
        document.querySelector('a-scene').addEventListener('arjs-video-loaded', function (e) {
            log("–í–∏–¥–µ–æ–ø–æ—Ç–æ–∫ –ø–æ–ª—É—á–µ–Ω!");
        });
    </script>
</body>
</html>